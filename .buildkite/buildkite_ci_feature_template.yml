# {FEATURE_NAME}
agents:
  queue: {QUEUE}
steps:
  - label: "Unit tests for {FEATURE_NAME}"
    key: "ut_{SAFE_FEATURE_NAME}"
    commands:
      # Replace to actual test commands
      - echo "[DEBUG], unit testing for {FEATURE_NAME}"
  - label: "Notifications: Unit tests for {FEATURE_NAME}"
    key: "notifications_ut_{SAFE_FEATURE_NAME}"
    depends_on: "ut_{SAFE_FEATURE_NAME}"
    agents:
      queue: {QUEUE}
    env:
      EXECUTE_ENTITY: "{FEATURE_NAME}"
      EXECUTE_STAGE: "UnitTest"
    commands:
      - |
        bash .buildkite/scripts/check_results.sh \
          "Unit tests for {FEATURE_NAME}" ut_{SAFE_FEATURE_NAME}

  - label: "Integration tests for {FEATURE_NAME}"
    key: "it_{SAFE_FEATURE_NAME}"
    depends_on: "notifications_ut_{SAFE_FEATURE_NAME}"
    commands:
      # Replace to actual test commands
      - echo "[DEBUG], integration testing for {FEATURE_NAME}"
  - label: "Notifications: Integration tests for {FEATURE_NAME}"
    key: "notifications_it_{SAFE_FEATURE_NAME}"
    depends_on: "it_{SAFE_FEATURE_NAME}"
    agents:
      queue: {QUEUE}
    env:
      EXECUTE_ENTITY: "{FEATURE_NAME}"
      EXECUTE_STAGE: "IntTest"
    commands:
      - |
        bash .buildkite/scripts/check_results.sh \
          "Integration tests for {FEATURE_NAME}" it_{SAFE_FEATURE_NAME}

  - label: "Performance benchmarks for {FEATURE_NAME}"
    key: "pb_{SAFE_FEATURE_NAME}"
    depends_on: "notifications_it_{SAFE_FEATURE_NAME}"
    commands:
      # Replace to actual test commands
      - echo "[DEBUG], performance benchmarking for {FEATURE_NAME}"
  - label: "Notifications: Performance benchmarks for {FEATURE_NAME}"
    key: "notifications_pb_{SAFE_FEATURE_NAME}"
    depends_on: "pb_{SAFE_FEATURE_NAME}"
    agents:
      queue: {QUEUE}
    env:
      EXECUTE_ENTITY: "{FEATURE_NAME}"
      EXECUTE_STAGE: "Benchmark"
    commands:
      - |
        bash .buildkite/scripts/check_results.sh \
          "Performance benchmarks for {FEATURE_NAME}" pb_{SAFE_FEATURE_NAME}

  - label: "Stress tests for {FEATURE_NAME}"
    key: "st_{SAFE_FEATURE_NAME}"
    depends_on: "notifications_pb_{SAFE_FEATURE_NAME}"
    commands:
      # Replace to actual test commands
      - echo "[DEBUG], stress testing for {FEATURE_NAME}"
  - label: "Notifications: Stress tests for {FEATURE_NAME}"
    key: "notifications_st_{SAFE_FEATURE_NAME}"
    depends_on: "st_{SAFE_FEATURE_NAME}"
    agents:
      queue: {QUEUE}
    env:
      EXECUTE_ENTITY: "{FEATURE_NAME}"
      EXECUTE_STAGE: "StressTest"
    commands:
      - |
        bash .buildkite/scripts/check_results.sh \
          "Stress tests for {FEATURE_NAME}" st_{SAFE_FEATURE_NAME}
